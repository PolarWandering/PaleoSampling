

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Comparison of different sampling approaches &#8212; Quantitative Analysis of Paleomagnetic Sampling Strategies</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/Sampling_comparison';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Example of sampling" href="Sampling_example.html" />
    <link rel="prev" title="DIY Figure 1" href="DIY-Figure1.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../book/intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Quantitative Analysis of Paleomagnetic Sampling Strategies - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Quantitative Analysis of Paleomagnetic Sampling Strategies - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../book/intro.html">
                    Quantitative Analysis of Paleomagnetic Sampling Strategies
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Installation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../book/installation.html">Installation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Analysis</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="DIY-Figure1.html">DIY Figure 1</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Comparison of different sampling approaches</a></li>
<li class="toctree-l1"><a class="reference internal" href="Sampling_example.html">Example of sampling</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Figures</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../figures/figure1/Figure1.html">Figure 1: Mean Squared Error as a function of the samples per site and sites</a></li>
<li class="toctree-l1"><a class="reference internal" href="../figures/figure2/Figure2.html">Figure 2:  Decay as a function of the number of samples and sites</a></li>
<li class="toctree-l1"><a class="reference internal" href="../figures/figure3_histogram/Figure3_hist.html">Figure 3: Histogram comparing sampling strategies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../figures/figure3_intersection/Figure3_intersection.html">Figure 3: Intersection of errors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../figures/figure3_heatmap/Figure3_heatmap.html">Figure 3: Intersection as function of dispersion parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../figures/figure4_boxplot/Figure4_boxplot.html">Figure 4: Boxplot</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendix</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Parallel.html">Parallelization with Dask</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/PolarWandering/PaleoSampling/HEAD/v2/gh/PolarWandering/PaleoSampling/main?urlpath=tree/notebooks/Sampling_comparison.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/PolarWandering/PaleoSampling" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/PolarWandering/PaleoSampling/issues/new?title=Issue%20on%20page%20%2Fnotebooks/Sampling_comparison.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/notebooks/Sampling_comparison.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Comparison of different sampling approaches</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-python-packages">Import Python packages</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#define-parameters">Define parameters</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#enter-parameters-that-are-the-same-in-both-sampling-strategies">Enter parameters that are the same in both sampling strategies</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#enter-sites-and-samples-per-site-for-approach-1">Enter sites and samples per site for approach 1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#enter-sites-and-samples-per-site-for-approach-2">Enter sites and samples per site for approach 2</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#assign-parameters-for-each-approach">Assign parameters for each approach</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#generate-the-simulations-with-the-chosen-parameters">Generate the simulations with the chosen parameters</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#chose-the-outlier-detection-strategy">Chose the outlier detection strategy</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#chose-number-of-iterations">Chose number of iterations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#run-the-simulations">Run the simulations</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#assess-the-simulated-results">Assess the simulated results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-rmse">Calculate RMSE</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-error-angle-percentile">Calculate error angle percentile</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-distribution-of-error-angles">Plot distribution of error angles</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="comparison-of-different-sampling-approaches">
<h1>Comparison of different sampling approaches<a class="headerlink" href="#comparison-of-different-sampling-approaches" title="Permalink to this heading">#</a></h1>
<p>This notebook enables comparison of different sampling approaches for estimating pole position in the presence of secular variation of the geomagnetic field and within site scatter. You can use this notebook to make a comparison similar to that shown below from Figure 3s of Sapienza et al. (2023) while providing your own parameters.</p>
<table style="border-collapse: collapse; border: none;">
    <tr>
        <td style="border: none;"><img src="https://raw.githubusercontent.com/PolarWandering/PaleoSampling/57e98e6cc79638b28949893508981cbfcc3a1643/figures/figure3_histogram/Figure3a.png" width="500"></td>
        <td style="border: none; vertical-align: bottom; width: 300px;">
            <b>Figure 3a:</b> Comparison between two different sampling strategies to determine a mean paleomagnetic pole position in the presence of outliers for a fixed number of total samples (n = 100). The red histograms and curve are strategy 1 where we have one sample per site (n0 = 1), one hundred sites (N = 100) and we use the Vandamme filter. The blue histograms and curve are strategy 2 where n0 = 5, (N = 20) and we filter all the outliers (perfect detection algorithm) for (a) p_outlier = 0.10.
        </td>
    </tr>
</table>
<p>These tools can help guide decisions about the tradeoffs between the number of site (<span class="math notranslate nohighlight">\(N\)</span>) and the number of samples per site (<span class="math notranslate nohighlight">\(n_0\)</span>) while evaluating or designing a study.</p>
<section id="import-python-packages">
<h2>Import Python packages<a class="headerlink" href="#import-python-packages" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="kn">import</span> <span class="nn">pmagpy.pmag</span> <span class="k">as</span> <span class="nn">pmag</span>
<span class="kn">import</span> <span class="nn">pmagpy.ipmag</span> <span class="k">as</span> <span class="nn">ipmag</span>

<span class="kn">import</span> <span class="nn">smpsite</span> <span class="k">as</span> <span class="nn">smp</span>

<span class="kn">import</span> <span class="nn">warnings</span> 
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</div>
</section>
<section id="define-parameters">
<h2>Define parameters<a class="headerlink" href="#define-parameters" title="Permalink to this heading">#</a></h2>
<p>The data generation model requires that the following parameters are given:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">site_lat</span></code> is the latitude of the study site (between 0 and 90º)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">outlier_rate</span></code> which is the fraction of samples that are spurious (between 0.0 [0% outliers] and 1.0 [100% outliers])</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">kappa_within_site</span></code> Fisher precision parameter (<span class="math notranslate nohighlight">\(\kappa\)</span>) for the samples within a site</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">secular_method</span></code> is the method used to estimate secular variation with the options being <code class="docutils literal notranslate"><span class="pre">&quot;G&quot;</span></code> (model G), <code class="docutils literal notranslate"><span class="pre">&quot;tk03&quot;</span></code> (TK03), or <code class="docutils literal notranslate"><span class="pre">&quot;Fisher&quot;</span></code> (Fisher distribution). If <code class="docutils literal notranslate"><span class="pre">&quot;Fisher&quot;</span></code> is chosen, a <code class="docutils literal notranslate"><span class="pre">kappa_secular</span></code> needs to be defined which is the Fisher precision parameter associated with secular variation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">N</span></code> number of sites</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">n0</span></code> number of samples per site</p></li>
</ul>
<section id="enter-parameters-that-are-the-same-in-both-sampling-strategies">
<h3>Enter parameters that are the same in both sampling strategies<a class="headerlink" href="#enter-parameters-that-are-the-same-in-both-sampling-strategies" title="Permalink to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">latitude</span></code>, <code class="docutils literal notranslate"><span class="pre">outlier_rate</span></code>, <code class="docutils literal notranslate"><span class="pre">kappa_within_site</span></code>, and <code class="docutils literal notranslate"><span class="pre">secular_method</span></code> make sense to define across both sampling strategies that are being compared. Let’s define them in the cell below (<strong>you can change these values to match those that are the best estimates for your study</strong>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># enter the values for the scenario you are exploring</span>
<span class="n">site_lat</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">site_long</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">outlier_rate</span> <span class="o">=</span> <span class="mf">0.10</span>
<span class="n">kappa_within_site</span> <span class="o">=</span> <span class="mi">60</span>
<span class="n">secular_method</span> <span class="o">=</span> <span class="s2">&quot;G&quot;</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="enter-sites-and-samples-per-site-for-approach-1">
<h3>Enter sites and samples per site for approach 1<a class="headerlink" href="#enter-sites-and-samples-per-site-for-approach-1" title="Permalink to this heading">#</a></h3>
<p>Now we can set how many sites and samples per sites for approach 1 (say 100 sites with 1 sample each for a total of 100 samples):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># enter the number of sites for approach 1</span>
<span class="n">N_approach1</span> <span class="o">=</span> <span class="mi">100</span> 
<span class="c1"># enter the number of samples per site for approach 1</span>
<span class="n">n0_approach1</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="enter-sites-and-samples-per-site-for-approach-2">
<h3>Enter sites and samples per site for approach 2<a class="headerlink" href="#enter-sites-and-samples-per-site-for-approach-2" title="Permalink to this heading">#</a></h3>
<p>Now we can set how many sites and samples per sites for approach 2 (say 20 sites with 5 samples each for a total of 100 samples):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># enter the number of sites for approach 2</span>
<span class="n">N_approach2</span> <span class="o">=</span> <span class="mi">20</span> 
<span class="c1"># enter the number of samples per site for approach 2</span>
<span class="n">n0_approach2</span> <span class="o">=</span> <span class="mi">5</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="assign-parameters-for-each-approach">
<h2>Assign parameters for each approach<a class="headerlink" href="#assign-parameters-for-each-approach" title="Permalink to this heading">#</a></h2>
<p>We will create a parameters object that has these values assigned for approach 1 (<code class="docutils literal notranslate"><span class="pre">params1</span></code>) and for approach 2 (<code class="docutils literal notranslate"><span class="pre">params2</span></code>). Nothing needs to be changed in the code cell below as it will take the values that are defined above.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">params1</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">Params</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">N_approach1</span><span class="p">,</span>
                     <span class="n">n0</span><span class="o">=</span><span class="n">n0_approach1</span><span class="p">,</span>
                     <span class="n">kappa_within_site</span><span class="o">=</span><span class="n">kappa_within_site</span><span class="p">,</span>
                     <span class="n">site_lat</span><span class="o">=</span><span class="n">site_lat</span><span class="p">,</span> 
                     <span class="n">site_long</span><span class="o">=</span><span class="n">site_long</span><span class="p">,</span>
                     <span class="n">outlier_rate</span><span class="o">=</span><span class="n">outlier_rate</span><span class="p">,</span>
                     <span class="n">secular_method</span><span class="o">=</span><span class="n">secular_method</span><span class="p">,</span>
                     <span class="n">kappa_secular</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

<span class="n">params2</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">Params</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">N_approach2</span><span class="p">,</span>
                     <span class="n">n0</span><span class="o">=</span><span class="n">n0_approach2</span><span class="p">,</span>
                     <span class="n">kappa_within_site</span><span class="o">=</span><span class="n">kappa_within_site</span><span class="p">,</span>
                     <span class="n">site_lat</span><span class="o">=</span><span class="n">site_lat</span><span class="p">,</span> 
                     <span class="n">site_long</span><span class="o">=</span><span class="n">site_long</span><span class="p">,</span>
                     <span class="n">outlier_rate</span><span class="o">=</span><span class="n">outlier_rate</span><span class="p">,</span>
                     <span class="n">secular_method</span><span class="o">=</span><span class="n">secular_method</span><span class="p">,</span>
                     <span class="n">kappa_secular</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="generate-the-simulations-with-the-chosen-parameters">
<h2>Generate the simulations with the chosen parameters<a class="headerlink" href="#generate-the-simulations-with-the-chosen-parameters" title="Permalink to this heading">#</a></h2>
<section id="chose-the-outlier-detection-strategy">
<h3>Chose the outlier detection strategy<a class="headerlink" href="#chose-the-outlier-detection-strategy" title="Permalink to this heading">#</a></h3>
<p>There are three options for outlier detection:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;True&quot;</span></code> This choice corresponds to perfect outlier detection. Recall that the outliers are generated at the sample level. One can envision that with 6 samples per site and a 10% outlier rate that it would be straight forward to be able to filter out outliers by looking for site level consistency.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;False&quot;</span></code> This choice corresponds to no outlier detection. All samples are used regardless of their position in calculating the site level means without filtering.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;vandamme&quot;</span></code> This choice corresponds to using the Vandamme (1994) filter to detect outlier directions. This approach provides a quantitative way to filter outliers for a 1 sample per site sampling strategy</p></li>
</ul>
<p>We need to assign an outlier detection strategy for approach 1 and approach 2. In the versions of these approaches given above where approach 1 is 50 sites with 1 sample per site and approach 2 is 10 sites with 5 samples per site, the approach could be taken of using the <code class="docutils literal notranslate"><span class="pre">vandamme</span></code> method for approach 1 and the <code class="docutils literal notranslate"><span class="pre">True</span></code> perfect outlier detection method for approach 2.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#assign &quot;True&quot; or &quot;False&quot; or &quot;vandamme&quot; for approach 1</span>
<span class="n">approach1_outlier_method</span> <span class="o">=</span> <span class="s2">&quot;vandamme&quot;</span>

<span class="c1">#assign &quot;True&quot; or &quot;False&quot; or &quot;vandamme&quot; for approach 2</span>
<span class="n">approach2_outlier_method</span> <span class="o">=</span> <span class="s2">&quot;True&quot;</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="chose-number-of-iterations">
<h3>Chose number of iterations<a class="headerlink" href="#chose-number-of-iterations" title="Permalink to this heading">#</a></h3>
<p>Before the simulations are run, the number of times the poles are simulated needs to be specified with the <code class="docutils literal notranslate"><span class="pre">n_iters</span></code> variable. Something like 1000 should do a decent job showing the resulting distribution. We used <code class="docutils literal notranslate"><span class="pre">n_iters</span> <span class="pre">=</span> <span class="pre">1000</span></code> in Sapienza et al. 2023.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#change the number of iterations if you want</span>
<span class="n">n_iters</span> <span class="o">=</span> <span class="mi">1000</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="run-the-simulations">
<h3>Run the simulations<a class="headerlink" href="#run-the-simulations" title="Permalink to this heading">#</a></h3>
<p>The simulations take a while to run (and will take longer for large values of <code class="docutils literal notranslate"><span class="pre">n_inters</span></code>)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>

<span class="n">approach_1_estimates</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">simulate_estimations</span><span class="p">(</span><span class="n">params1</span><span class="p">,</span> <span class="n">n_iters</span><span class="o">=</span><span class="n">n_iters</span><span class="p">,</span> <span class="n">ignore_outliers</span><span class="o">=</span><span class="n">approach1_outlier_method</span><span class="p">)</span>
<span class="n">approach_2_estimates</span> <span class="o">=</span> <span class="n">smp</span><span class="o">.</span><span class="n">simulate_estimations</span><span class="p">(</span><span class="n">params2</span><span class="p">,</span> <span class="n">n_iters</span><span class="o">=</span><span class="n">n_iters</span><span class="p">,</span> <span class="n">ignore_outliers</span><span class="o">=</span><span class="n">approach2_outlier_method</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 1min 32s, sys: 336 ms, total: 1min 33s
Wall time: 1min 33s
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="assess-the-simulated-results">
<h2>Assess the simulated results<a class="headerlink" href="#assess-the-simulated-results" title="Permalink to this heading">#</a></h2>
<section id="calculate-rmse">
<h3>Calculate RMSE<a class="headerlink" href="#calculate-rmse" title="Permalink to this heading">#</a></h3>
<p>The root mean square error of all of the simulations combined can be calculated for a given approach.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">approach_1_rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">approach_1_estimates</span><span class="o">.</span><span class="n">error_angle</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">.5</span>
<span class="n">approach_2_rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">approach_2_estimates</span><span class="o">.</span><span class="n">error_angle</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">.5</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The RMSE for approach 1 is: &#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">approach_1_rmse</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="s1">&#39;º&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The RMSE for approach 2 is: &#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">approach_2_rmse</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="s1">&#39;º&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The RMSE for approach 1 is:  1.9 º
The RMSE for approach 2 is:  3.4 º
</pre></div>
</div>
</div>
</div>
</section>
<section id="calculate-error-angle-percentile">
<h3>Calculate error angle percentile<a class="headerlink" href="#calculate-error-angle-percentile" title="Permalink to this heading">#</a></h3>
<p>Rather than assessing the mean error, it could be informative to investigate the percentile of the resulting error angles. Calculating the 95 percentile assesses what the error angle is that 95% of the simulations are for the parameters of a given scenario.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">approach_1_95_percentile</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">approach_1_estimates</span><span class="o">.</span><span class="n">error_angle</span><span class="p">,</span><span class="mi">95</span><span class="p">)</span>
<span class="n">approach_2_95_percentile</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">approach_2_estimates</span><span class="o">.</span><span class="n">error_angle</span><span class="p">,</span><span class="mi">95</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The 95 percentile error angle for approach 1 is: &#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">approach_1_95_percentile</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="s1">&#39;º&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The 95 percentile error angle for approach 2 is: &#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">approach_2_95_percentile</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="s1">&#39;º&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The 95 percentile error angle for approach 1 is:  3.3 º
The 95 percentile error angle for approach 2 is:  6.1 º
</pre></div>
</div>
</div>
</div>
</section>
<section id="plot-distribution-of-error-angles">
<h3>Plot distribution of error angles<a class="headerlink" href="#plot-distribution-of-error-angles" title="Permalink to this heading">#</a></h3>
<p>The distribution of the error angles from the two approaches can be plotted. First, let’s extract the parameters associated with each approach to plot on the figure.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">annotation_text</span><span class="p">(</span><span class="n">approach_name</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">outlier_method</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate annotation text based on provided parameters and outlier detection method.</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        approach_name (str): The name of the approach (e.g. &quot;Approach 1&quot;).</span>
<span class="sd">        params (object): An object containing attributes related to simulation parameters.</span>
<span class="sd">        outlier_method (str): The name of the outlier detection method (&quot;vandamme&quot;, &quot;True&quot;, or &quot;False&quot;).</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">        str: A formatted annotation string containing simulation parameters and outlier method.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">outlier_method</span> <span class="o">==</span> <span class="s2">&quot;vandamme&quot;</span><span class="p">:</span>
        <span class="n">outlier_method</span> <span class="o">=</span> <span class="s2">&quot;Vandamme&quot;</span>
    <span class="k">elif</span> <span class="n">outlier_method</span> <span class="o">==</span> <span class="s2">&quot;True&quot;</span><span class="p">:</span>
        <span class="n">outlier_method</span> <span class="o">=</span> <span class="s2">&quot;perfect&quot;</span>
    <span class="k">elif</span> <span class="n">outlier_method</span> <span class="o">==</span> <span class="s2">&quot;False&quot;</span><span class="p">:</span>
        <span class="n">outlier_method</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span>
    
    <span class="c1"># Display the specified params1 attributes in the annotation box</span>
    <span class="n">annotation_text</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">approach_name</span><span class="si">}</span><span class="s1">:</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="sa">f</span><span class="s1">&#39;number of sites = </span><span class="si">{</span><span class="n">params</span><span class="o">.</span><span class="n">N</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="sa">f</span><span class="s1">&#39;samples per site = </span><span class="si">{</span><span class="n">params</span><span class="o">.</span><span class="n">n0</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="sa">f</span><span class="s1">&#39;within site kappa = </span><span class="si">{</span><span class="n">params</span><span class="o">.</span><span class="n">kappa_within_site</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="sa">f</span><span class="s1">&#39;site latitude = </span><span class="si">{</span><span class="n">params</span><span class="o">.</span><span class="n">site_lat</span><span class="si">}</span><span class="s1">º</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="sa">f</span><span class="s1">&#39;outlier rate = </span><span class="si">{</span><span class="n">params</span><span class="o">.</span><span class="n">outlier_rate</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="sa">f</span><span class="s1">&#39;secular variation model = </span><span class="si">{</span><span class="n">params</span><span class="o">.</span><span class="n">secular_method</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="sa">f</span><span class="s1">&#39;outlier detection = </span><span class="si">{</span><span class="n">outlier_method</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">annotation_text</span>

<span class="n">annotation_text_approach1</span> <span class="o">=</span> <span class="n">annotation_text</span><span class="p">(</span><span class="s1">&#39;Approach 1&#39;</span><span class="p">,</span> <span class="n">params1</span><span class="p">,</span> <span class="n">approach1_outlier_method</span><span class="p">)</span>
<span class="n">annotation_text_approach2</span> <span class="o">=</span> <span class="n">annotation_text</span><span class="p">(</span><span class="s1">&#39;Approach 2&#39;</span><span class="p">,</span> <span class="n">params2</span><span class="p">,</span> <span class="n">approach2_outlier_method</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now we can make the plot showing histograms of the error angle for each approach.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate the 99.9 percentile for each approach to set axes x scale</span>
<span class="n">percentile_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">approach_1_estimates</span><span class="o">.</span><span class="n">error_angle</span><span class="p">,</span> <span class="mf">99.9</span><span class="p">)</span>
<span class="n">percentile_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">approach_2_estimates</span><span class="o">.</span><span class="n">error_angle</span><span class="p">,</span> <span class="mf">99.9</span><span class="p">)</span>

<span class="c1"># Find the maximum value between the two percentiles and round up to nearest integer</span>
<span class="n">max_x_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">percentile_1</span><span class="p">,</span> <span class="n">percentile_2</span><span class="p">))</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">approach_1_estimates</span><span class="o">.</span><span class="n">error_angle</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#e84118&#39;</span><span class="p">,</span> 
             <span class="n">stat</span><span class="o">=</span><span class="s1">&#39;probability&#39;</span><span class="p">,</span> <span class="n">binwidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">binrange</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_x_value</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.7</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">approach_2_estimates</span><span class="o">.</span><span class="n">error_angle</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#0097e6&#39;</span><span class="p">,</span> 
             <span class="n">stat</span><span class="o">=</span><span class="s1">&#39;probability&#39;</span><span class="p">,</span> <span class="n">binwidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">binrange</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_x_value</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.7</span><span class="p">)</span>

<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;error angle (º)&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">rmse</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="p">[</span><span class="n">approach_1_rmse</span><span class="p">,</span> <span class="n">approach_2_rmse</span><span class="p">]):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">rmse</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;RMSE = </span><span class="si">{</span><span class="n">rmse</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">rmse</span><span class="p">,</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mf">0.95</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">textcoords</span><span class="o">=</span><span class="s1">&#39;offset points&#39;</span><span class="p">,</span> 
                <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

<span class="n">props</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;round&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;wheat&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.98</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="n">annotation_text_approach1</span><span class="p">,</span> 
             <span class="n">transform</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="n">props</span><span class="p">)</span> 
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.98</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="n">annotation_text_approach2</span><span class="p">,</span> 
             <span class="n">transform</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="n">props</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/6482b49f911a40fb840fedb4a013ef22af97a2e90b0168b65cd7d206311f5d03.png" src="../_images/6482b49f911a40fb840fedb4a013ef22af97a2e90b0168b65cd7d206311f5d03.png" />
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="DIY-Figure1.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">DIY Figure 1</p>
      </div>
    </a>
    <a class="right-next"
       href="Sampling_example.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Example of sampling</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-python-packages">Import Python packages</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#define-parameters">Define parameters</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#enter-parameters-that-are-the-same-in-both-sampling-strategies">Enter parameters that are the same in both sampling strategies</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#enter-sites-and-samples-per-site-for-approach-1">Enter sites and samples per site for approach 1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#enter-sites-and-samples-per-site-for-approach-2">Enter sites and samples per site for approach 2</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#assign-parameters-for-each-approach">Assign parameters for each approach</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#generate-the-simulations-with-the-chosen-parameters">Generate the simulations with the chosen parameters</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#chose-the-outlier-detection-strategy">Chose the outlier detection strategy</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#chose-number-of-iterations">Chose number of iterations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#run-the-simulations">Run the simulations</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#assess-the-simulated-results">Assess the simulated results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-rmse">Calculate RMSE</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-error-angle-percentile">Calculate error angle percentile</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-distribution-of-error-angles">Plot distribution of error angles</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Facundo Sapienza
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>